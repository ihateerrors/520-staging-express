<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map</title>

    <!-- Bootstrap 5 CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">


<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />

<!-- Google Maps JavaScript API (Replace with your API Key) -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-12">
                <div id="map" style="height: 800px;"></div>
            </div>
        </div>
    </div>
    
 
<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>


<script>
    const map = L.map('map').setView([47.6407, -122.2971], 15);  // SR 520 area
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    fetch('/api/latest-banner-project')
        .then(response => response.json())
        .then(data => {
            if (data && data.length > 0) {
                const project = data[0];
                const geoJSONData = JSON.parse(project.mapData);

                const startDate = project.startDate 
                    ? moment(project.startDate).format('MM/DD/YYYY') 
                    : "Not specified";

                const endDate = project.endDate 
                    ? moment(project.endDate).format('MM/DD/YYYY') 
                    : "Not specified";

                const popupContent = `
                    <div class="popup-content">
                        <h5>${project.activityName}</h5>
                        <p>Start: ${startDate}</p>
                        <p>End: ${endDate}</p>
                        <p>Time: ${project.time || "Not specified"}</p>
                        ${project.imageUrl ? `<img src="${project.imageUrl}" alt="Image for ${project.activityName}" class="img-fluid popup-image">` : ''}
                        <a href="/projects/${project._id}" class="btn btn-primary mt-2">View Details</a>
                    </div>
                `;

                L.geoJSON(geoJSONData, {
                    onEachFeature: function (feature, layer) {
                        layer.bindPopup(popupContent);
                    }
                }).addTo(map);
            }
        })
        .catch(error => {
            console.error('Error fetching map data:', error);
        });
</script>




<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.min.js" integrity="sha384-/YR4Ck4OdCWrM+L4l9ibx4Ck4SOF4y4Ck4SOF4y4Ck4C2DgHfViXydVeLm+JDMZD" crossorigin="anonymous"></script> -->

</body>
</html>
